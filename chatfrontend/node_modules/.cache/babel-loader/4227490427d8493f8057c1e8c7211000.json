{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar decode_codepoint_1 = __importDefault(require(\"entities/lib/decode_codepoint\"));\n\nvar entities_json_1 = __importDefault(require(\"entities/lib/maps/entities.json\"));\n\nvar legacy_json_1 = __importDefault(require(\"entities/lib/maps/legacy.json\"));\n\nvar xml_json_1 = __importDefault(require(\"entities/lib/maps/xml.json\"));\n\nfunction whitespace(c) {\n  return c === \" \" || c === \"\\n\" || c === \"\\t\" || c === \"\\f\" || c === \"\\r\";\n}\n\nfunction isASCIIAlpha(c) {\n  return c >= \"a\" && c <= \"z\" || c >= \"A\" && c <= \"Z\";\n}\n\nfunction ifElseState(upper, SUCCESS, FAILURE) {\n  var lower = upper.toLowerCase();\n\n  if (upper === lower) {\n    return function (t, c) {\n      if (c === lower) {\n        t._state = SUCCESS;\n      } else {\n        t._state = FAILURE;\n        t._index--;\n      }\n    };\n  }\n\n  return function (t, c) {\n    if (c === lower || c === upper) {\n      t._state = SUCCESS;\n    } else {\n      t._state = FAILURE;\n      t._index--;\n    }\n  };\n}\n\nfunction consumeSpecialNameChar(upper, NEXT_STATE) {\n  var lower = upper.toLowerCase();\n  return function (t, c) {\n    if (c === lower || c === upper) {\n      t._state = NEXT_STATE;\n    } else {\n      t._state = 3\n      /* InTagName */\n      ;\n      t._index--; // Consume the token again\n    }\n  };\n}\n\nvar stateBeforeCdata1 = ifElseState(\"C\", 24\n/* BeforeCdata2 */\n, 16\n/* InDeclaration */\n);\nvar stateBeforeCdata2 = ifElseState(\"D\", 25\n/* BeforeCdata3 */\n, 16\n/* InDeclaration */\n);\nvar stateBeforeCdata3 = ifElseState(\"A\", 26\n/* BeforeCdata4 */\n, 16\n/* InDeclaration */\n);\nvar stateBeforeCdata4 = ifElseState(\"T\", 27\n/* BeforeCdata5 */\n, 16\n/* InDeclaration */\n);\nvar stateBeforeCdata5 = ifElseState(\"A\", 28\n/* BeforeCdata6 */\n, 16\n/* InDeclaration */\n);\nvar stateBeforeScript1 = consumeSpecialNameChar(\"R\", 35\n/* BeforeScript2 */\n);\nvar stateBeforeScript2 = consumeSpecialNameChar(\"I\", 36\n/* BeforeScript3 */\n);\nvar stateBeforeScript3 = consumeSpecialNameChar(\"P\", 37\n/* BeforeScript4 */\n);\nvar stateBeforeScript4 = consumeSpecialNameChar(\"T\", 38\n/* BeforeScript5 */\n);\nvar stateAfterScript1 = ifElseState(\"R\", 40\n/* AfterScript2 */\n, 1\n/* Text */\n);\nvar stateAfterScript2 = ifElseState(\"I\", 41\n/* AfterScript3 */\n, 1\n/* Text */\n);\nvar stateAfterScript3 = ifElseState(\"P\", 42\n/* AfterScript4 */\n, 1\n/* Text */\n);\nvar stateAfterScript4 = ifElseState(\"T\", 43\n/* AfterScript5 */\n, 1\n/* Text */\n);\nvar stateBeforeStyle1 = consumeSpecialNameChar(\"Y\", 45\n/* BeforeStyle2 */\n);\nvar stateBeforeStyle2 = consumeSpecialNameChar(\"L\", 46\n/* BeforeStyle3 */\n);\nvar stateBeforeStyle3 = consumeSpecialNameChar(\"E\", 47\n/* BeforeStyle4 */\n);\nvar stateAfterStyle1 = ifElseState(\"Y\", 49\n/* AfterStyle2 */\n, 1\n/* Text */\n);\nvar stateAfterStyle2 = ifElseState(\"L\", 50\n/* AfterStyle3 */\n, 1\n/* Text */\n);\nvar stateAfterStyle3 = ifElseState(\"E\", 51\n/* AfterStyle4 */\n, 1\n/* Text */\n);\nvar stateBeforeSpecialT = consumeSpecialNameChar(\"I\", 54\n/* BeforeTitle1 */\n);\nvar stateBeforeTitle1 = consumeSpecialNameChar(\"T\", 55\n/* BeforeTitle2 */\n);\nvar stateBeforeTitle2 = consumeSpecialNameChar(\"L\", 56\n/* BeforeTitle3 */\n);\nvar stateBeforeTitle3 = consumeSpecialNameChar(\"E\", 57\n/* BeforeTitle4 */\n);\nvar stateAfterSpecialTEnd = ifElseState(\"I\", 58\n/* AfterTitle1 */\n, 1\n/* Text */\n);\nvar stateAfterTitle1 = ifElseState(\"T\", 59\n/* AfterTitle2 */\n, 1\n/* Text */\n);\nvar stateAfterTitle2 = ifElseState(\"L\", 60\n/* AfterTitle3 */\n, 1\n/* Text */\n);\nvar stateAfterTitle3 = ifElseState(\"E\", 61\n/* AfterTitle4 */\n, 1\n/* Text */\n);\nvar stateBeforeEntity = ifElseState(\"#\", 63\n/* BeforeNumericEntity */\n, 64\n/* InNamedEntity */\n);\nvar stateBeforeNumericEntity = ifElseState(\"X\", 66\n/* InHexEntity */\n, 65\n/* InNumericEntity */\n);\n\nvar Tokenizer =\n/** @class */\nfunction () {\n  function Tokenizer(options, cbs) {\n    var _a;\n    /** The current state the tokenizer is in. */\n\n\n    this._state = 1\n    /* Text */\n    ;\n    /** The read buffer. */\n\n    this.buffer = \"\";\n    /** The beginning of the section that is currently being read. */\n\n    this.sectionStart = 0;\n    /** The index within the buffer that we are currently looking at. */\n\n    this._index = 0;\n    /**\n     * Data that has already been processed will be removed from the buffer occasionally.\n     * `_bufferOffset` keeps track of how many characters have been removed, to make sure position information is accurate.\n     */\n\n    this.bufferOffset = 0;\n    /** Some behavior, eg. when decoding entities, is done while we are in another state. This keeps track of the other state type. */\n\n    this.baseState = 1\n    /* Text */\n    ;\n    /** For special parsing behavior inside of script and style tags. */\n\n    this.special = 1\n    /* None */\n    ;\n    /** Indicates whether the tokenizer has been paused. */\n\n    this.running = true;\n    /** Indicates whether the tokenizer has finished running / `.end` has been called. */\n\n    this.ended = false;\n    this.cbs = cbs;\n    this.xmlMode = !!(options === null || options === void 0 ? void 0 : options.xmlMode);\n    this.decodeEntities = (_a = options === null || options === void 0 ? void 0 : options.decodeEntities) !== null && _a !== void 0 ? _a : true;\n  }\n\n  Tokenizer.prototype.reset = function () {\n    this._state = 1\n    /* Text */\n    ;\n    this.buffer = \"\";\n    this.sectionStart = 0;\n    this._index = 0;\n    this.bufferOffset = 0;\n    this.baseState = 1\n    /* Text */\n    ;\n    this.special = 1\n    /* None */\n    ;\n    this.running = true;\n    this.ended = false;\n  };\n\n  Tokenizer.prototype.write = function (chunk) {\n    if (this.ended) this.cbs.onerror(Error(\".write() after done!\"));\n    this.buffer += chunk;\n    this.parse();\n  };\n\n  Tokenizer.prototype.end = function (chunk) {\n    if (this.ended) this.cbs.onerror(Error(\".end() after done!\"));\n    if (chunk) this.write(chunk);\n    this.ended = true;\n    if (this.running) this.finish();\n  };\n\n  Tokenizer.prototype.pause = function () {\n    this.running = false;\n  };\n\n  Tokenizer.prototype.resume = function () {\n    this.running = true;\n\n    if (this._index < this.buffer.length) {\n      this.parse();\n    }\n\n    if (this.ended) {\n      this.finish();\n    }\n  };\n  /**\n   * The current index within all of the written data.\n   */\n\n\n  Tokenizer.prototype.getAbsoluteIndex = function () {\n    return this.bufferOffset + this._index;\n  };\n\n  Tokenizer.prototype.stateText = function (c) {\n    if (c === \"<\") {\n      if (this._index > this.sectionStart) {\n        this.cbs.ontext(this.getSection());\n      }\n\n      this._state = 2\n      /* BeforeTagName */\n      ;\n      this.sectionStart = this._index;\n    } else if (this.decodeEntities && c === \"&\" && (this.special === 1\n    /* None */\n    || this.special === 4\n    /* Title */\n    )) {\n      if (this._index > this.sectionStart) {\n        this.cbs.ontext(this.getSection());\n      }\n\n      this.baseState = 1\n      /* Text */\n      ;\n      this._state = 62\n      /* BeforeEntity */\n      ;\n      this.sectionStart = this._index;\n    }\n  };\n  /**\n   * HTML only allows ASCII alpha characters (a-z and A-Z) at the beginning of a tag name.\n   *\n   * XML allows a lot more characters here (@see https://www.w3.org/TR/REC-xml/#NT-NameStartChar).\n   * We allow anything that wouldn't end the tag.\n   */\n\n\n  Tokenizer.prototype.isTagStartChar = function (c) {\n    return isASCIIAlpha(c) || this.xmlMode && !whitespace(c) && c !== \"/\" && c !== \">\";\n  };\n\n  Tokenizer.prototype.stateBeforeTagName = function (c) {\n    if (c === \"/\") {\n      this._state = 5\n      /* BeforeClosingTagName */\n      ;\n    } else if (c === \"<\") {\n      this.cbs.ontext(this.getSection());\n      this.sectionStart = this._index;\n    } else if (c === \">\" || this.special !== 1\n    /* None */\n    || whitespace(c)) {\n      this._state = 1\n      /* Text */\n      ;\n    } else if (c === \"!\") {\n      this._state = 15\n      /* BeforeDeclaration */\n      ;\n      this.sectionStart = this._index + 1;\n    } else if (c === \"?\") {\n      this._state = 17\n      /* InProcessingInstruction */\n      ;\n      this.sectionStart = this._index + 1;\n    } else if (!this.isTagStartChar(c)) {\n      this._state = 1\n      /* Text */\n      ;\n    } else {\n      this._state = !this.xmlMode && (c === \"s\" || c === \"S\") ? 32\n      /* BeforeSpecialS */\n      : !this.xmlMode && (c === \"t\" || c === \"T\") ? 52\n      /* BeforeSpecialT */\n      : 3\n      /* InTagName */\n      ;\n      this.sectionStart = this._index;\n    }\n  };\n\n  Tokenizer.prototype.stateInTagName = function (c) {\n    if (c === \"/\" || c === \">\" || whitespace(c)) {\n      this.emitToken(\"onopentagname\");\n      this._state = 8\n      /* BeforeAttributeName */\n      ;\n      this._index--;\n    }\n  };\n\n  Tokenizer.prototype.stateBeforeClosingTagName = function (c) {\n    if (whitespace(c)) {// Ignore\n    } else if (c === \">\") {\n      this._state = 1\n      /* Text */\n      ;\n    } else if (this.special !== 1\n    /* None */\n    ) {\n      if (this.special !== 4\n      /* Title */\n      && (c === \"s\" || c === \"S\")) {\n        this._state = 33\n        /* BeforeSpecialSEnd */\n        ;\n      } else if (this.special === 4\n      /* Title */\n      && (c === \"t\" || c === \"T\")) {\n        this._state = 53\n        /* BeforeSpecialTEnd */\n        ;\n      } else {\n        this._state = 1\n        /* Text */\n        ;\n        this._index--;\n      }\n    } else if (!this.isTagStartChar(c)) {\n      this._state = 20\n      /* InSpecialComment */\n      ;\n      this.sectionStart = this._index;\n    } else {\n      this._state = 6\n      /* InClosingTagName */\n      ;\n      this.sectionStart = this._index;\n    }\n  };\n\n  Tokenizer.prototype.stateInClosingTagName = function (c) {\n    if (c === \">\" || whitespace(c)) {\n      this.emitToken(\"onclosetag\");\n      this._state = 7\n      /* AfterClosingTagName */\n      ;\n      this._index--;\n    }\n  };\n\n  Tokenizer.prototype.stateAfterClosingTagName = function (c) {\n    // Skip everything until \">\"\n    if (c === \">\") {\n      this._state = 1\n      /* Text */\n      ;\n      this.sectionStart = this._index + 1;\n    }\n  };\n\n  Tokenizer.prototype.stateBeforeAttributeName = function (c) {\n    if (c === \">\") {\n      this.cbs.onopentagend();\n      this._state = 1\n      /* Text */\n      ;\n      this.sectionStart = this._index + 1;\n    } else if (c === \"/\") {\n      this._state = 4\n      /* InSelfClosingTag */\n      ;\n    } else if (!whitespace(c)) {\n      this._state = 9\n      /* InAttributeName */\n      ;\n      this.sectionStart = this._index;\n    }\n  };\n\n  Tokenizer.prototype.stateInSelfClosingTag = function (c) {\n    if (c === \">\") {\n      this.cbs.onselfclosingtag();\n      this._state = 1\n      /* Text */\n      ;\n      this.sectionStart = this._index + 1;\n      this.special = 1\n      /* None */\n      ; // Reset special state, in case of self-closing special tags\n    } else if (!whitespace(c)) {\n      this._state = 8\n      /* BeforeAttributeName */\n      ;\n      this._index--;\n    }\n  };\n\n  Tokenizer.prototype.stateInAttributeName = function (c) {\n    if (c === \"=\" || c === \"/\" || c === \">\" || whitespace(c)) {\n      this.cbs.onattribname(this.getSection());\n      this.sectionStart = -1;\n      this._state = 10\n      /* AfterAttributeName */\n      ;\n      this._index--;\n    }\n  };\n\n  Tokenizer.prototype.stateAfterAttributeName = function (c) {\n    if (c === \"=\") {\n      this._state = 11\n      /* BeforeAttributeValue */\n      ;\n    } else if (c === \"/\" || c === \">\") {\n      this.cbs.onattribend(undefined);\n      this._state = 8\n      /* BeforeAttributeName */\n      ;\n      this._index--;\n    } else if (!whitespace(c)) {\n      this.cbs.onattribend(undefined);\n      this._state = 9\n      /* InAttributeName */\n      ;\n      this.sectionStart = this._index;\n    }\n  };\n\n  Tokenizer.prototype.stateBeforeAttributeValue = function (c) {\n    if (c === '\"') {\n      this._state = 12\n      /* InAttributeValueDq */\n      ;\n      this.sectionStart = this._index + 1;\n    } else if (c === \"'\") {\n      this._state = 13\n      /* InAttributeValueSq */\n      ;\n      this.sectionStart = this._index + 1;\n    } else if (!whitespace(c)) {\n      this._state = 14\n      /* InAttributeValueNq */\n      ;\n      this.sectionStart = this._index;\n      this._index--; // Reconsume token\n    }\n  };\n\n  Tokenizer.prototype.handleInAttributeValue = function (c, quote) {\n    if (c === quote) {\n      this.emitToken(\"onattribdata\");\n      this.cbs.onattribend(quote);\n      this._state = 8\n      /* BeforeAttributeName */\n      ;\n    } else if (this.decodeEntities && c === \"&\") {\n      this.emitToken(\"onattribdata\");\n      this.baseState = this._state;\n      this._state = 62\n      /* BeforeEntity */\n      ;\n      this.sectionStart = this._index;\n    }\n  };\n\n  Tokenizer.prototype.stateInAttributeValueDoubleQuotes = function (c) {\n    this.handleInAttributeValue(c, '\"');\n  };\n\n  Tokenizer.prototype.stateInAttributeValueSingleQuotes = function (c) {\n    this.handleInAttributeValue(c, \"'\");\n  };\n\n  Tokenizer.prototype.stateInAttributeValueNoQuotes = function (c) {\n    if (whitespace(c) || c === \">\") {\n      this.emitToken(\"onattribdata\");\n      this.cbs.onattribend(null);\n      this._state = 8\n      /* BeforeAttributeName */\n      ;\n      this._index--;\n    } else if (this.decodeEntities && c === \"&\") {\n      this.emitToken(\"onattribdata\");\n      this.baseState = this._state;\n      this._state = 62\n      /* BeforeEntity */\n      ;\n      this.sectionStart = this._index;\n    }\n  };\n\n  Tokenizer.prototype.stateBeforeDeclaration = function (c) {\n    this._state = c === \"[\" ? 23\n    /* BeforeCdata1 */\n    : c === \"-\" ? 18\n    /* BeforeComment */\n    : 16\n    /* InDeclaration */\n    ;\n  };\n\n  Tokenizer.prototype.stateInDeclaration = function (c) {\n    if (c === \">\") {\n      this.cbs.ondeclaration(this.getSection());\n      this._state = 1\n      /* Text */\n      ;\n      this.sectionStart = this._index + 1;\n    }\n  };\n\n  Tokenizer.prototype.stateInProcessingInstruction = function (c) {\n    if (c === \">\") {\n      this.cbs.onprocessinginstruction(this.getSection());\n      this._state = 1\n      /* Text */\n      ;\n      this.sectionStart = this._index + 1;\n    }\n  };\n\n  Tokenizer.prototype.stateBeforeComment = function (c) {\n    if (c === \"-\") {\n      this._state = 19\n      /* InComment */\n      ;\n      this.sectionStart = this._index + 1;\n    } else {\n      this._state = 16\n      /* InDeclaration */\n      ;\n    }\n  };\n\n  Tokenizer.prototype.stateInComment = function (c) {\n    if (c === \"-\") this._state = 21\n    /* AfterComment1 */\n    ;\n  };\n\n  Tokenizer.prototype.stateInSpecialComment = function (c) {\n    if (c === \">\") {\n      this.cbs.oncomment(this.buffer.substring(this.sectionStart, this._index));\n      this._state = 1\n      /* Text */\n      ;\n      this.sectionStart = this._index + 1;\n    }\n  };\n\n  Tokenizer.prototype.stateAfterComment1 = function (c) {\n    if (c === \"-\") {\n      this._state = 22\n      /* AfterComment2 */\n      ;\n    } else {\n      this._state = 19\n      /* InComment */\n      ;\n    }\n  };\n\n  Tokenizer.prototype.stateAfterComment2 = function (c) {\n    if (c === \">\") {\n      // Remove 2 trailing chars\n      this.cbs.oncomment(this.buffer.substring(this.sectionStart, this._index - 2));\n      this._state = 1\n      /* Text */\n      ;\n      this.sectionStart = this._index + 1;\n    } else if (c !== \"-\") {\n      this._state = 19\n      /* InComment */\n      ;\n    } // Else: stay in AFTER_COMMENT_2 (`--->`)\n\n  };\n\n  Tokenizer.prototype.stateBeforeCdata6 = function (c) {\n    if (c === \"[\") {\n      this._state = 29\n      /* InCdata */\n      ;\n      this.sectionStart = this._index + 1;\n    } else {\n      this._state = 16\n      /* InDeclaration */\n      ;\n      this._index--;\n    }\n  };\n\n  Tokenizer.prototype.stateInCdata = function (c) {\n    if (c === \"]\") this._state = 30\n    /* AfterCdata1 */\n    ;\n  };\n\n  Tokenizer.prototype.stateAfterCdata1 = function (c) {\n    if (c === \"]\") this._state = 31\n    /* AfterCdata2 */\n    ;else this._state = 29\n    /* InCdata */\n    ;\n  };\n\n  Tokenizer.prototype.stateAfterCdata2 = function (c) {\n    if (c === \">\") {\n      // Remove 2 trailing chars\n      this.cbs.oncdata(this.buffer.substring(this.sectionStart, this._index - 2));\n      this._state = 1\n      /* Text */\n      ;\n      this.sectionStart = this._index + 1;\n    } else if (c !== \"]\") {\n      this._state = 29\n      /* InCdata */\n      ;\n    } // Else: stay in AFTER_CDATA_2 (`]]]>`)\n\n  };\n\n  Tokenizer.prototype.stateBeforeSpecialS = function (c) {\n    if (c === \"c\" || c === \"C\") {\n      this._state = 34\n      /* BeforeScript1 */\n      ;\n    } else if (c === \"t\" || c === \"T\") {\n      this._state = 44\n      /* BeforeStyle1 */\n      ;\n    } else {\n      this._state = 3\n      /* InTagName */\n      ;\n      this._index--; // Consume the token again\n    }\n  };\n\n  Tokenizer.prototype.stateBeforeSpecialSEnd = function (c) {\n    if (this.special === 2\n    /* Script */\n    && (c === \"c\" || c === \"C\")) {\n      this._state = 39\n      /* AfterScript1 */\n      ;\n    } else if (this.special === 3\n    /* Style */\n    && (c === \"t\" || c === \"T\")) {\n      this._state = 48\n      /* AfterStyle1 */\n      ;\n    } else this._state = 1\n    /* Text */\n    ;\n  };\n\n  Tokenizer.prototype.stateBeforeSpecialLast = function (c, special) {\n    if (c === \"/\" || c === \">\" || whitespace(c)) {\n      this.special = special;\n    }\n\n    this._state = 3\n    /* InTagName */\n    ;\n    this._index--; // Consume the token again\n  };\n\n  Tokenizer.prototype.stateAfterSpecialLast = function (c, sectionStartOffset) {\n    if (c === \">\" || whitespace(c)) {\n      this.special = 1\n      /* None */\n      ;\n      this._state = 6\n      /* InClosingTagName */\n      ;\n      this.sectionStart = this._index - sectionStartOffset;\n      this._index--; // Reconsume the token\n    } else this._state = 1\n    /* Text */\n    ;\n  }; // For entities terminated with a semicolon\n\n\n  Tokenizer.prototype.parseFixedEntity = function (map) {\n    if (map === void 0) {\n      map = this.xmlMode ? xml_json_1.default : entities_json_1.default;\n    } // Offset = 1\n\n\n    if (this.sectionStart + 1 < this._index) {\n      var entity = this.buffer.substring(this.sectionStart + 1, this._index);\n\n      if (Object.prototype.hasOwnProperty.call(map, entity)) {\n        this.emitPartial(map[entity]);\n        this.sectionStart = this._index + 1;\n      }\n    }\n  }; // Parses legacy entities (without trailing semicolon)\n\n\n  Tokenizer.prototype.parseLegacyEntity = function () {\n    var start = this.sectionStart + 1; // The max length of legacy entities is 6\n\n    var limit = Math.min(this._index - start, 6);\n\n    while (limit >= 2) {\n      // The min length of legacy entities is 2\n      var entity = this.buffer.substr(start, limit);\n\n      if (Object.prototype.hasOwnProperty.call(legacy_json_1.default, entity)) {\n        this.emitPartial(legacy_json_1.default[entity]);\n        this.sectionStart += limit + 1;\n        return;\n      }\n\n      limit--;\n    }\n  };\n\n  Tokenizer.prototype.stateInNamedEntity = function (c) {\n    if (c === \";\") {\n      this.parseFixedEntity(); // Retry as legacy entity if entity wasn't parsed\n\n      if (this.baseState === 1\n      /* Text */\n      && this.sectionStart + 1 < this._index && !this.xmlMode) {\n        this.parseLegacyEntity();\n      }\n\n      this._state = this.baseState;\n    } else if ((c < \"0\" || c > \"9\") && !isASCIIAlpha(c)) {\n      if (this.xmlMode || this.sectionStart + 1 === this._index) {// Ignore\n      } else if (this.baseState !== 1\n      /* Text */\n      ) {\n        if (c !== \"=\") {\n          // Parse as legacy entity, without allowing additional characters.\n          this.parseFixedEntity(legacy_json_1.default);\n        }\n      } else {\n        this.parseLegacyEntity();\n      }\n\n      this._state = this.baseState;\n      this._index--;\n    }\n  };\n\n  Tokenizer.prototype.decodeNumericEntity = function (offset, base, strict) {\n    var sectionStart = this.sectionStart + offset;\n\n    if (sectionStart !== this._index) {\n      // Parse entity\n      var entity = this.buffer.substring(sectionStart, this._index);\n      var parsed = parseInt(entity, base);\n      this.emitPartial(decode_codepoint_1.default(parsed));\n      this.sectionStart = strict ? this._index + 1 : this._index;\n    }\n\n    this._state = this.baseState;\n  };\n\n  Tokenizer.prototype.stateInNumericEntity = function (c) {\n    if (c === \";\") {\n      this.decodeNumericEntity(2, 10, true);\n    } else if (c < \"0\" || c > \"9\") {\n      if (!this.xmlMode) {\n        this.decodeNumericEntity(2, 10, false);\n      } else {\n        this._state = this.baseState;\n      }\n\n      this._index--;\n    }\n  };\n\n  Tokenizer.prototype.stateInHexEntity = function (c) {\n    if (c === \";\") {\n      this.decodeNumericEntity(3, 16, true);\n    } else if ((c < \"a\" || c > \"f\") && (c < \"A\" || c > \"F\") && (c < \"0\" || c > \"9\")) {\n      if (!this.xmlMode) {\n        this.decodeNumericEntity(3, 16, false);\n      } else {\n        this._state = this.baseState;\n      }\n\n      this._index--;\n    }\n  };\n\n  Tokenizer.prototype.cleanup = function () {\n    if (this.sectionStart < 0) {\n      this.buffer = \"\";\n      this.bufferOffset += this._index;\n      this._index = 0;\n    } else if (this.running) {\n      if (this._state === 1\n      /* Text */\n      ) {\n        if (this.sectionStart !== this._index) {\n          this.cbs.ontext(this.buffer.substr(this.sectionStart));\n        }\n\n        this.buffer = \"\";\n        this.bufferOffset += this._index;\n        this._index = 0;\n      } else if (this.sectionStart === this._index) {\n        // The section just started\n        this.buffer = \"\";\n        this.bufferOffset += this._index;\n        this._index = 0;\n      } else {\n        // Remove everything unnecessary\n        this.buffer = this.buffer.substr(this.sectionStart);\n        this._index -= this.sectionStart;\n        this.bufferOffset += this.sectionStart;\n      }\n\n      this.sectionStart = 0;\n    }\n  };\n  /**\n   * Iterates through the buffer, calling the function corresponding to the current state.\n   *\n   * States that are more likely to be hit are higher up, as a performance improvement.\n   */\n\n\n  Tokenizer.prototype.parse = function () {\n    while (this._index < this.buffer.length && this.running) {\n      var c = this.buffer.charAt(this._index);\n\n      if (this._state === 1\n      /* Text */\n      ) {\n        this.stateText(c);\n      } else if (this._state === 12\n      /* InAttributeValueDq */\n      ) {\n        this.stateInAttributeValueDoubleQuotes(c);\n      } else if (this._state === 9\n      /* InAttributeName */\n      ) {\n        this.stateInAttributeName(c);\n      } else if (this._state === 19\n      /* InComment */\n      ) {\n        this.stateInComment(c);\n      } else if (this._state === 20\n      /* InSpecialComment */\n      ) {\n        this.stateInSpecialComment(c);\n      } else if (this._state === 8\n      /* BeforeAttributeName */\n      ) {\n        this.stateBeforeAttributeName(c);\n      } else if (this._state === 3\n      /* InTagName */\n      ) {\n        this.stateInTagName(c);\n      } else if (this._state === 6\n      /* InClosingTagName */\n      ) {\n        this.stateInClosingTagName(c);\n      } else if (this._state === 2\n      /* BeforeTagName */\n      ) {\n        this.stateBeforeTagName(c);\n      } else if (this._state === 10\n      /* AfterAttributeName */\n      ) {\n        this.stateAfterAttributeName(c);\n      } else if (this._state === 13\n      /* InAttributeValueSq */\n      ) {\n        this.stateInAttributeValueSingleQuotes(c);\n      } else if (this._state === 11\n      /* BeforeAttributeValue */\n      ) {\n        this.stateBeforeAttributeValue(c);\n      } else if (this._state === 5\n      /* BeforeClosingTagName */\n      ) {\n        this.stateBeforeClosingTagName(c);\n      } else if (this._state === 7\n      /* AfterClosingTagName */\n      ) {\n        this.stateAfterClosingTagName(c);\n      } else if (this._state === 32\n      /* BeforeSpecialS */\n      ) {\n        this.stateBeforeSpecialS(c);\n      } else if (this._state === 21\n      /* AfterComment1 */\n      ) {\n        this.stateAfterComment1(c);\n      } else if (this._state === 14\n      /* InAttributeValueNq */\n      ) {\n        this.stateInAttributeValueNoQuotes(c);\n      } else if (this._state === 4\n      /* InSelfClosingTag */\n      ) {\n        this.stateInSelfClosingTag(c);\n      } else if (this._state === 16\n      /* InDeclaration */\n      ) {\n        this.stateInDeclaration(c);\n      } else if (this._state === 15\n      /* BeforeDeclaration */\n      ) {\n        this.stateBeforeDeclaration(c);\n      } else if (this._state === 22\n      /* AfterComment2 */\n      ) {\n        this.stateAfterComment2(c);\n      } else if (this._state === 18\n      /* BeforeComment */\n      ) {\n        this.stateBeforeComment(c);\n      } else if (this._state === 33\n      /* BeforeSpecialSEnd */\n      ) {\n        this.stateBeforeSpecialSEnd(c);\n      } else if (this._state === 53\n      /* BeforeSpecialTEnd */\n      ) {\n        stateAfterSpecialTEnd(this, c);\n      } else if (this._state === 39\n      /* AfterScript1 */\n      ) {\n        stateAfterScript1(this, c);\n      } else if (this._state === 40\n      /* AfterScript2 */\n      ) {\n        stateAfterScript2(this, c);\n      } else if (this._state === 41\n      /* AfterScript3 */\n      ) {\n        stateAfterScript3(this, c);\n      } else if (this._state === 34\n      /* BeforeScript1 */\n      ) {\n        stateBeforeScript1(this, c);\n      } else if (this._state === 35\n      /* BeforeScript2 */\n      ) {\n        stateBeforeScript2(this, c);\n      } else if (this._state === 36\n      /* BeforeScript3 */\n      ) {\n        stateBeforeScript3(this, c);\n      } else if (this._state === 37\n      /* BeforeScript4 */\n      ) {\n        stateBeforeScript4(this, c);\n      } else if (this._state === 38\n      /* BeforeScript5 */\n      ) {\n        this.stateBeforeSpecialLast(c, 2\n        /* Script */\n        );\n      } else if (this._state === 42\n      /* AfterScript4 */\n      ) {\n        stateAfterScript4(this, c);\n      } else if (this._state === 43\n      /* AfterScript5 */\n      ) {\n        this.stateAfterSpecialLast(c, 6);\n      } else if (this._state === 44\n      /* BeforeStyle1 */\n      ) {\n        stateBeforeStyle1(this, c);\n      } else if (this._state === 29\n      /* InCdata */\n      ) {\n        this.stateInCdata(c);\n      } else if (this._state === 45\n      /* BeforeStyle2 */\n      ) {\n        stateBeforeStyle2(this, c);\n      } else if (this._state === 46\n      /* BeforeStyle3 */\n      ) {\n        stateBeforeStyle3(this, c);\n      } else if (this._state === 47\n      /* BeforeStyle4 */\n      ) {\n        this.stateBeforeSpecialLast(c, 3\n        /* Style */\n        );\n      } else if (this._state === 48\n      /* AfterStyle1 */\n      ) {\n        stateAfterStyle1(this, c);\n      } else if (this._state === 49\n      /* AfterStyle2 */\n      ) {\n        stateAfterStyle2(this, c);\n      } else if (this._state === 50\n      /* AfterStyle3 */\n      ) {\n        stateAfterStyle3(this, c);\n      } else if (this._state === 51\n      /* AfterStyle4 */\n      ) {\n        this.stateAfterSpecialLast(c, 5);\n      } else if (this._state === 52\n      /* BeforeSpecialT */\n      ) {\n        stateBeforeSpecialT(this, c);\n      } else if (this._state === 54\n      /* BeforeTitle1 */\n      ) {\n        stateBeforeTitle1(this, c);\n      } else if (this._state === 55\n      /* BeforeTitle2 */\n      ) {\n        stateBeforeTitle2(this, c);\n      } else if (this._state === 56\n      /* BeforeTitle3 */\n      ) {\n        stateBeforeTitle3(this, c);\n      } else if (this._state === 57\n      /* BeforeTitle4 */\n      ) {\n        this.stateBeforeSpecialLast(c, 4\n        /* Title */\n        );\n      } else if (this._state === 58\n      /* AfterTitle1 */\n      ) {\n        stateAfterTitle1(this, c);\n      } else if (this._state === 59\n      /* AfterTitle2 */\n      ) {\n        stateAfterTitle2(this, c);\n      } else if (this._state === 60\n      /* AfterTitle3 */\n      ) {\n        stateAfterTitle3(this, c);\n      } else if (this._state === 61\n      /* AfterTitle4 */\n      ) {\n        this.stateAfterSpecialLast(c, 5);\n      } else if (this._state === 17\n      /* InProcessingInstruction */\n      ) {\n        this.stateInProcessingInstruction(c);\n      } else if (this._state === 64\n      /* InNamedEntity */\n      ) {\n        this.stateInNamedEntity(c);\n      } else if (this._state === 23\n      /* BeforeCdata1 */\n      ) {\n        stateBeforeCdata1(this, c);\n      } else if (this._state === 62\n      /* BeforeEntity */\n      ) {\n        stateBeforeEntity(this, c);\n      } else if (this._state === 24\n      /* BeforeCdata2 */\n      ) {\n        stateBeforeCdata2(this, c);\n      } else if (this._state === 25\n      /* BeforeCdata3 */\n      ) {\n        stateBeforeCdata3(this, c);\n      } else if (this._state === 30\n      /* AfterCdata1 */\n      ) {\n        this.stateAfterCdata1(c);\n      } else if (this._state === 31\n      /* AfterCdata2 */\n      ) {\n        this.stateAfterCdata2(c);\n      } else if (this._state === 26\n      /* BeforeCdata4 */\n      ) {\n        stateBeforeCdata4(this, c);\n      } else if (this._state === 27\n      /* BeforeCdata5 */\n      ) {\n        stateBeforeCdata5(this, c);\n      } else if (this._state === 28\n      /* BeforeCdata6 */\n      ) {\n        this.stateBeforeCdata6(c);\n      } else if (this._state === 66\n      /* InHexEntity */\n      ) {\n        this.stateInHexEntity(c);\n      } else if (this._state === 65\n      /* InNumericEntity */\n      ) {\n        this.stateInNumericEntity(c); // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n      } else if (this._state === 63\n      /* BeforeNumericEntity */\n      ) {\n        stateBeforeNumericEntity(this, c);\n      } else {\n        this.cbs.onerror(Error(\"unknown _state\"), this._state);\n      }\n\n      this._index++;\n    }\n\n    this.cleanup();\n  };\n\n  Tokenizer.prototype.finish = function () {\n    // If there is remaining data, emit it in a reasonable way\n    if (this.sectionStart < this._index) {\n      this.handleTrailingData();\n    }\n\n    this.cbs.onend();\n  };\n\n  Tokenizer.prototype.handleTrailingData = function () {\n    var data = this.buffer.substr(this.sectionStart);\n\n    if (this._state === 29\n    /* InCdata */\n    || this._state === 30\n    /* AfterCdata1 */\n    || this._state === 31\n    /* AfterCdata2 */\n    ) {\n      this.cbs.oncdata(data);\n    } else if (this._state === 19\n    /* InComment */\n    || this._state === 21\n    /* AfterComment1 */\n    || this._state === 22\n    /* AfterComment2 */\n    ) {\n      this.cbs.oncomment(data);\n    } else if (this._state === 64\n    /* InNamedEntity */\n    && !this.xmlMode) {\n      this.parseLegacyEntity();\n\n      if (this.sectionStart < this._index) {\n        this._state = this.baseState;\n        this.handleTrailingData();\n      }\n    } else if (this._state === 65\n    /* InNumericEntity */\n    && !this.xmlMode) {\n      this.decodeNumericEntity(2, 10, false);\n\n      if (this.sectionStart < this._index) {\n        this._state = this.baseState;\n        this.handleTrailingData();\n      }\n    } else if (this._state === 66\n    /* InHexEntity */\n    && !this.xmlMode) {\n      this.decodeNumericEntity(3, 16, false);\n\n      if (this.sectionStart < this._index) {\n        this._state = this.baseState;\n        this.handleTrailingData();\n      }\n    } else if (this._state !== 3\n    /* InTagName */\n    && this._state !== 8\n    /* BeforeAttributeName */\n    && this._state !== 11\n    /* BeforeAttributeValue */\n    && this._state !== 10\n    /* AfterAttributeName */\n    && this._state !== 9\n    /* InAttributeName */\n    && this._state !== 13\n    /* InAttributeValueSq */\n    && this._state !== 12\n    /* InAttributeValueDq */\n    && this._state !== 14\n    /* InAttributeValueNq */\n    && this._state !== 6\n    /* InClosingTagName */\n    ) {\n      this.cbs.ontext(data);\n    }\n    /*\n     * Else, ignore remaining data\n     * TODO add a way to remove current tag\n     */\n\n  };\n\n  Tokenizer.prototype.getSection = function () {\n    return this.buffer.substring(this.sectionStart, this._index);\n  };\n\n  Tokenizer.prototype.emitToken = function (name) {\n    this.cbs[name](this.getSection());\n    this.sectionStart = -1;\n  };\n\n  Tokenizer.prototype.emitPartial = function (value) {\n    if (this.baseState !== 1\n    /* Text */\n    ) {\n      this.cbs.onattribdata(value); // TODO implement the new event\n    } else {\n      this.cbs.ontext(value);\n    }\n  };\n\n  return Tokenizer;\n}();\n\nexports.default = Tokenizer;","map":{"version":3,"names":["__importDefault","mod","__esModule","Object","defineProperty","exports","value","decode_codepoint_1","require","entities_json_1","legacy_json_1","xml_json_1","whitespace","c","isASCIIAlpha","ifElseState","upper","SUCCESS","FAILURE","lower","toLowerCase","t","_state","_index","consumeSpecialNameChar","NEXT_STATE","stateBeforeCdata1","stateBeforeCdata2","stateBeforeCdata3","stateBeforeCdata4","stateBeforeCdata5","stateBeforeScript1","stateBeforeScript2","stateBeforeScript3","stateBeforeScript4","stateAfterScript1","stateAfterScript2","stateAfterScript3","stateAfterScript4","stateBeforeStyle1","stateBeforeStyle2","stateBeforeStyle3","stateAfterStyle1","stateAfterStyle2","stateAfterStyle3","stateBeforeSpecialT","stateBeforeTitle1","stateBeforeTitle2","stateBeforeTitle3","stateAfterSpecialTEnd","stateAfterTitle1","stateAfterTitle2","stateAfterTitle3","stateBeforeEntity","stateBeforeNumericEntity","Tokenizer","options","cbs","_a","buffer","sectionStart","bufferOffset","baseState","special","running","ended","xmlMode","decodeEntities","prototype","reset","write","chunk","onerror","Error","parse","end","finish","pause","resume","length","getAbsoluteIndex","stateText","ontext","getSection","isTagStartChar","stateBeforeTagName","stateInTagName","emitToken","stateBeforeClosingTagName","stateInClosingTagName","stateAfterClosingTagName","stateBeforeAttributeName","onopentagend","stateInSelfClosingTag","onselfclosingtag","stateInAttributeName","onattribname","stateAfterAttributeName","onattribend","undefined","stateBeforeAttributeValue","handleInAttributeValue","quote","stateInAttributeValueDoubleQuotes","stateInAttributeValueSingleQuotes","stateInAttributeValueNoQuotes","stateBeforeDeclaration","stateInDeclaration","ondeclaration","stateInProcessingInstruction","onprocessinginstruction","stateBeforeComment","stateInComment","stateInSpecialComment","oncomment","substring","stateAfterComment1","stateAfterComment2","stateBeforeCdata6","stateInCdata","stateAfterCdata1","stateAfterCdata2","oncdata","stateBeforeSpecialS","stateBeforeSpecialSEnd","stateBeforeSpecialLast","stateAfterSpecialLast","sectionStartOffset","parseFixedEntity","map","default","entity","hasOwnProperty","call","emitPartial","parseLegacyEntity","start","limit","Math","min","substr","stateInNamedEntity","decodeNumericEntity","offset","base","strict","parsed","parseInt","stateInNumericEntity","stateInHexEntity","cleanup","charAt","handleTrailingData","onend","data","name","onattribdata"],"sources":["/Users/thendo/Desktop/WEMEET/node_modules/htmlparser2/lib/Tokenizer.js"],"sourcesContent":["\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar decode_codepoint_1 = __importDefault(require(\"entities/lib/decode_codepoint\"));\nvar entities_json_1 = __importDefault(require(\"entities/lib/maps/entities.json\"));\nvar legacy_json_1 = __importDefault(require(\"entities/lib/maps/legacy.json\"));\nvar xml_json_1 = __importDefault(require(\"entities/lib/maps/xml.json\"));\nfunction whitespace(c) {\n    return c === \" \" || c === \"\\n\" || c === \"\\t\" || c === \"\\f\" || c === \"\\r\";\n}\nfunction isASCIIAlpha(c) {\n    return (c >= \"a\" && c <= \"z\") || (c >= \"A\" && c <= \"Z\");\n}\nfunction ifElseState(upper, SUCCESS, FAILURE) {\n    var lower = upper.toLowerCase();\n    if (upper === lower) {\n        return function (t, c) {\n            if (c === lower) {\n                t._state = SUCCESS;\n            }\n            else {\n                t._state = FAILURE;\n                t._index--;\n            }\n        };\n    }\n    return function (t, c) {\n        if (c === lower || c === upper) {\n            t._state = SUCCESS;\n        }\n        else {\n            t._state = FAILURE;\n            t._index--;\n        }\n    };\n}\nfunction consumeSpecialNameChar(upper, NEXT_STATE) {\n    var lower = upper.toLowerCase();\n    return function (t, c) {\n        if (c === lower || c === upper) {\n            t._state = NEXT_STATE;\n        }\n        else {\n            t._state = 3 /* InTagName */;\n            t._index--; // Consume the token again\n        }\n    };\n}\nvar stateBeforeCdata1 = ifElseState(\"C\", 24 /* BeforeCdata2 */, 16 /* InDeclaration */);\nvar stateBeforeCdata2 = ifElseState(\"D\", 25 /* BeforeCdata3 */, 16 /* InDeclaration */);\nvar stateBeforeCdata3 = ifElseState(\"A\", 26 /* BeforeCdata4 */, 16 /* InDeclaration */);\nvar stateBeforeCdata4 = ifElseState(\"T\", 27 /* BeforeCdata5 */, 16 /* InDeclaration */);\nvar stateBeforeCdata5 = ifElseState(\"A\", 28 /* BeforeCdata6 */, 16 /* InDeclaration */);\nvar stateBeforeScript1 = consumeSpecialNameChar(\"R\", 35 /* BeforeScript2 */);\nvar stateBeforeScript2 = consumeSpecialNameChar(\"I\", 36 /* BeforeScript3 */);\nvar stateBeforeScript3 = consumeSpecialNameChar(\"P\", 37 /* BeforeScript4 */);\nvar stateBeforeScript4 = consumeSpecialNameChar(\"T\", 38 /* BeforeScript5 */);\nvar stateAfterScript1 = ifElseState(\"R\", 40 /* AfterScript2 */, 1 /* Text */);\nvar stateAfterScript2 = ifElseState(\"I\", 41 /* AfterScript3 */, 1 /* Text */);\nvar stateAfterScript3 = ifElseState(\"P\", 42 /* AfterScript4 */, 1 /* Text */);\nvar stateAfterScript4 = ifElseState(\"T\", 43 /* AfterScript5 */, 1 /* Text */);\nvar stateBeforeStyle1 = consumeSpecialNameChar(\"Y\", 45 /* BeforeStyle2 */);\nvar stateBeforeStyle2 = consumeSpecialNameChar(\"L\", 46 /* BeforeStyle3 */);\nvar stateBeforeStyle3 = consumeSpecialNameChar(\"E\", 47 /* BeforeStyle4 */);\nvar stateAfterStyle1 = ifElseState(\"Y\", 49 /* AfterStyle2 */, 1 /* Text */);\nvar stateAfterStyle2 = ifElseState(\"L\", 50 /* AfterStyle3 */, 1 /* Text */);\nvar stateAfterStyle3 = ifElseState(\"E\", 51 /* AfterStyle4 */, 1 /* Text */);\nvar stateBeforeSpecialT = consumeSpecialNameChar(\"I\", 54 /* BeforeTitle1 */);\nvar stateBeforeTitle1 = consumeSpecialNameChar(\"T\", 55 /* BeforeTitle2 */);\nvar stateBeforeTitle2 = consumeSpecialNameChar(\"L\", 56 /* BeforeTitle3 */);\nvar stateBeforeTitle3 = consumeSpecialNameChar(\"E\", 57 /* BeforeTitle4 */);\nvar stateAfterSpecialTEnd = ifElseState(\"I\", 58 /* AfterTitle1 */, 1 /* Text */);\nvar stateAfterTitle1 = ifElseState(\"T\", 59 /* AfterTitle2 */, 1 /* Text */);\nvar stateAfterTitle2 = ifElseState(\"L\", 60 /* AfterTitle3 */, 1 /* Text */);\nvar stateAfterTitle3 = ifElseState(\"E\", 61 /* AfterTitle4 */, 1 /* Text */);\nvar stateBeforeEntity = ifElseState(\"#\", 63 /* BeforeNumericEntity */, 64 /* InNamedEntity */);\nvar stateBeforeNumericEntity = ifElseState(\"X\", 66 /* InHexEntity */, 65 /* InNumericEntity */);\nvar Tokenizer = /** @class */ (function () {\n    function Tokenizer(options, cbs) {\n        var _a;\n        /** The current state the tokenizer is in. */\n        this._state = 1 /* Text */;\n        /** The read buffer. */\n        this.buffer = \"\";\n        /** The beginning of the section that is currently being read. */\n        this.sectionStart = 0;\n        /** The index within the buffer that we are currently looking at. */\n        this._index = 0;\n        /**\n         * Data that has already been processed will be removed from the buffer occasionally.\n         * `_bufferOffset` keeps track of how many characters have been removed, to make sure position information is accurate.\n         */\n        this.bufferOffset = 0;\n        /** Some behavior, eg. when decoding entities, is done while we are in another state. This keeps track of the other state type. */\n        this.baseState = 1 /* Text */;\n        /** For special parsing behavior inside of script and style tags. */\n        this.special = 1 /* None */;\n        /** Indicates whether the tokenizer has been paused. */\n        this.running = true;\n        /** Indicates whether the tokenizer has finished running / `.end` has been called. */\n        this.ended = false;\n        this.cbs = cbs;\n        this.xmlMode = !!(options === null || options === void 0 ? void 0 : options.xmlMode);\n        this.decodeEntities = (_a = options === null || options === void 0 ? void 0 : options.decodeEntities) !== null && _a !== void 0 ? _a : true;\n    }\n    Tokenizer.prototype.reset = function () {\n        this._state = 1 /* Text */;\n        this.buffer = \"\";\n        this.sectionStart = 0;\n        this._index = 0;\n        this.bufferOffset = 0;\n        this.baseState = 1 /* Text */;\n        this.special = 1 /* None */;\n        this.running = true;\n        this.ended = false;\n    };\n    Tokenizer.prototype.write = function (chunk) {\n        if (this.ended)\n            this.cbs.onerror(Error(\".write() after done!\"));\n        this.buffer += chunk;\n        this.parse();\n    };\n    Tokenizer.prototype.end = function (chunk) {\n        if (this.ended)\n            this.cbs.onerror(Error(\".end() after done!\"));\n        if (chunk)\n            this.write(chunk);\n        this.ended = true;\n        if (this.running)\n            this.finish();\n    };\n    Tokenizer.prototype.pause = function () {\n        this.running = false;\n    };\n    Tokenizer.prototype.resume = function () {\n        this.running = true;\n        if (this._index < this.buffer.length) {\n            this.parse();\n        }\n        if (this.ended) {\n            this.finish();\n        }\n    };\n    /**\n     * The current index within all of the written data.\n     */\n    Tokenizer.prototype.getAbsoluteIndex = function () {\n        return this.bufferOffset + this._index;\n    };\n    Tokenizer.prototype.stateText = function (c) {\n        if (c === \"<\") {\n            if (this._index > this.sectionStart) {\n                this.cbs.ontext(this.getSection());\n            }\n            this._state = 2 /* BeforeTagName */;\n            this.sectionStart = this._index;\n        }\n        else if (this.decodeEntities &&\n            c === \"&\" &&\n            (this.special === 1 /* None */ || this.special === 4 /* Title */)) {\n            if (this._index > this.sectionStart) {\n                this.cbs.ontext(this.getSection());\n            }\n            this.baseState = 1 /* Text */;\n            this._state = 62 /* BeforeEntity */;\n            this.sectionStart = this._index;\n        }\n    };\n    /**\n     * HTML only allows ASCII alpha characters (a-z and A-Z) at the beginning of a tag name.\n     *\n     * XML allows a lot more characters here (@see https://www.w3.org/TR/REC-xml/#NT-NameStartChar).\n     * We allow anything that wouldn't end the tag.\n     */\n    Tokenizer.prototype.isTagStartChar = function (c) {\n        return (isASCIIAlpha(c) ||\n            (this.xmlMode && !whitespace(c) && c !== \"/\" && c !== \">\"));\n    };\n    Tokenizer.prototype.stateBeforeTagName = function (c) {\n        if (c === \"/\") {\n            this._state = 5 /* BeforeClosingTagName */;\n        }\n        else if (c === \"<\") {\n            this.cbs.ontext(this.getSection());\n            this.sectionStart = this._index;\n        }\n        else if (c === \">\" ||\n            this.special !== 1 /* None */ ||\n            whitespace(c)) {\n            this._state = 1 /* Text */;\n        }\n        else if (c === \"!\") {\n            this._state = 15 /* BeforeDeclaration */;\n            this.sectionStart = this._index + 1;\n        }\n        else if (c === \"?\") {\n            this._state = 17 /* InProcessingInstruction */;\n            this.sectionStart = this._index + 1;\n        }\n        else if (!this.isTagStartChar(c)) {\n            this._state = 1 /* Text */;\n        }\n        else {\n            this._state =\n                !this.xmlMode && (c === \"s\" || c === \"S\")\n                    ? 32 /* BeforeSpecialS */\n                    : !this.xmlMode && (c === \"t\" || c === \"T\")\n                        ? 52 /* BeforeSpecialT */\n                        : 3 /* InTagName */;\n            this.sectionStart = this._index;\n        }\n    };\n    Tokenizer.prototype.stateInTagName = function (c) {\n        if (c === \"/\" || c === \">\" || whitespace(c)) {\n            this.emitToken(\"onopentagname\");\n            this._state = 8 /* BeforeAttributeName */;\n            this._index--;\n        }\n    };\n    Tokenizer.prototype.stateBeforeClosingTagName = function (c) {\n        if (whitespace(c)) {\n            // Ignore\n        }\n        else if (c === \">\") {\n            this._state = 1 /* Text */;\n        }\n        else if (this.special !== 1 /* None */) {\n            if (this.special !== 4 /* Title */ && (c === \"s\" || c === \"S\")) {\n                this._state = 33 /* BeforeSpecialSEnd */;\n            }\n            else if (this.special === 4 /* Title */ &&\n                (c === \"t\" || c === \"T\")) {\n                this._state = 53 /* BeforeSpecialTEnd */;\n            }\n            else {\n                this._state = 1 /* Text */;\n                this._index--;\n            }\n        }\n        else if (!this.isTagStartChar(c)) {\n            this._state = 20 /* InSpecialComment */;\n            this.sectionStart = this._index;\n        }\n        else {\n            this._state = 6 /* InClosingTagName */;\n            this.sectionStart = this._index;\n        }\n    };\n    Tokenizer.prototype.stateInClosingTagName = function (c) {\n        if (c === \">\" || whitespace(c)) {\n            this.emitToken(\"onclosetag\");\n            this._state = 7 /* AfterClosingTagName */;\n            this._index--;\n        }\n    };\n    Tokenizer.prototype.stateAfterClosingTagName = function (c) {\n        // Skip everything until \">\"\n        if (c === \">\") {\n            this._state = 1 /* Text */;\n            this.sectionStart = this._index + 1;\n        }\n    };\n    Tokenizer.prototype.stateBeforeAttributeName = function (c) {\n        if (c === \">\") {\n            this.cbs.onopentagend();\n            this._state = 1 /* Text */;\n            this.sectionStart = this._index + 1;\n        }\n        else if (c === \"/\") {\n            this._state = 4 /* InSelfClosingTag */;\n        }\n        else if (!whitespace(c)) {\n            this._state = 9 /* InAttributeName */;\n            this.sectionStart = this._index;\n        }\n    };\n    Tokenizer.prototype.stateInSelfClosingTag = function (c) {\n        if (c === \">\") {\n            this.cbs.onselfclosingtag();\n            this._state = 1 /* Text */;\n            this.sectionStart = this._index + 1;\n            this.special = 1 /* None */; // Reset special state, in case of self-closing special tags\n        }\n        else if (!whitespace(c)) {\n            this._state = 8 /* BeforeAttributeName */;\n            this._index--;\n        }\n    };\n    Tokenizer.prototype.stateInAttributeName = function (c) {\n        if (c === \"=\" || c === \"/\" || c === \">\" || whitespace(c)) {\n            this.cbs.onattribname(this.getSection());\n            this.sectionStart = -1;\n            this._state = 10 /* AfterAttributeName */;\n            this._index--;\n        }\n    };\n    Tokenizer.prototype.stateAfterAttributeName = function (c) {\n        if (c === \"=\") {\n            this._state = 11 /* BeforeAttributeValue */;\n        }\n        else if (c === \"/\" || c === \">\") {\n            this.cbs.onattribend(undefined);\n            this._state = 8 /* BeforeAttributeName */;\n            this._index--;\n        }\n        else if (!whitespace(c)) {\n            this.cbs.onattribend(undefined);\n            this._state = 9 /* InAttributeName */;\n            this.sectionStart = this._index;\n        }\n    };\n    Tokenizer.prototype.stateBeforeAttributeValue = function (c) {\n        if (c === '\"') {\n            this._state = 12 /* InAttributeValueDq */;\n            this.sectionStart = this._index + 1;\n        }\n        else if (c === \"'\") {\n            this._state = 13 /* InAttributeValueSq */;\n            this.sectionStart = this._index + 1;\n        }\n        else if (!whitespace(c)) {\n            this._state = 14 /* InAttributeValueNq */;\n            this.sectionStart = this._index;\n            this._index--; // Reconsume token\n        }\n    };\n    Tokenizer.prototype.handleInAttributeValue = function (c, quote) {\n        if (c === quote) {\n            this.emitToken(\"onattribdata\");\n            this.cbs.onattribend(quote);\n            this._state = 8 /* BeforeAttributeName */;\n        }\n        else if (this.decodeEntities && c === \"&\") {\n            this.emitToken(\"onattribdata\");\n            this.baseState = this._state;\n            this._state = 62 /* BeforeEntity */;\n            this.sectionStart = this._index;\n        }\n    };\n    Tokenizer.prototype.stateInAttributeValueDoubleQuotes = function (c) {\n        this.handleInAttributeValue(c, '\"');\n    };\n    Tokenizer.prototype.stateInAttributeValueSingleQuotes = function (c) {\n        this.handleInAttributeValue(c, \"'\");\n    };\n    Tokenizer.prototype.stateInAttributeValueNoQuotes = function (c) {\n        if (whitespace(c) || c === \">\") {\n            this.emitToken(\"onattribdata\");\n            this.cbs.onattribend(null);\n            this._state = 8 /* BeforeAttributeName */;\n            this._index--;\n        }\n        else if (this.decodeEntities && c === \"&\") {\n            this.emitToken(\"onattribdata\");\n            this.baseState = this._state;\n            this._state = 62 /* BeforeEntity */;\n            this.sectionStart = this._index;\n        }\n    };\n    Tokenizer.prototype.stateBeforeDeclaration = function (c) {\n        this._state =\n            c === \"[\"\n                ? 23 /* BeforeCdata1 */\n                : c === \"-\"\n                    ? 18 /* BeforeComment */\n                    : 16 /* InDeclaration */;\n    };\n    Tokenizer.prototype.stateInDeclaration = function (c) {\n        if (c === \">\") {\n            this.cbs.ondeclaration(this.getSection());\n            this._state = 1 /* Text */;\n            this.sectionStart = this._index + 1;\n        }\n    };\n    Tokenizer.prototype.stateInProcessingInstruction = function (c) {\n        if (c === \">\") {\n            this.cbs.onprocessinginstruction(this.getSection());\n            this._state = 1 /* Text */;\n            this.sectionStart = this._index + 1;\n        }\n    };\n    Tokenizer.prototype.stateBeforeComment = function (c) {\n        if (c === \"-\") {\n            this._state = 19 /* InComment */;\n            this.sectionStart = this._index + 1;\n        }\n        else {\n            this._state = 16 /* InDeclaration */;\n        }\n    };\n    Tokenizer.prototype.stateInComment = function (c) {\n        if (c === \"-\")\n            this._state = 21 /* AfterComment1 */;\n    };\n    Tokenizer.prototype.stateInSpecialComment = function (c) {\n        if (c === \">\") {\n            this.cbs.oncomment(this.buffer.substring(this.sectionStart, this._index));\n            this._state = 1 /* Text */;\n            this.sectionStart = this._index + 1;\n        }\n    };\n    Tokenizer.prototype.stateAfterComment1 = function (c) {\n        if (c === \"-\") {\n            this._state = 22 /* AfterComment2 */;\n        }\n        else {\n            this._state = 19 /* InComment */;\n        }\n    };\n    Tokenizer.prototype.stateAfterComment2 = function (c) {\n        if (c === \">\") {\n            // Remove 2 trailing chars\n            this.cbs.oncomment(this.buffer.substring(this.sectionStart, this._index - 2));\n            this._state = 1 /* Text */;\n            this.sectionStart = this._index + 1;\n        }\n        else if (c !== \"-\") {\n            this._state = 19 /* InComment */;\n        }\n        // Else: stay in AFTER_COMMENT_2 (`--->`)\n    };\n    Tokenizer.prototype.stateBeforeCdata6 = function (c) {\n        if (c === \"[\") {\n            this._state = 29 /* InCdata */;\n            this.sectionStart = this._index + 1;\n        }\n        else {\n            this._state = 16 /* InDeclaration */;\n            this._index--;\n        }\n    };\n    Tokenizer.prototype.stateInCdata = function (c) {\n        if (c === \"]\")\n            this._state = 30 /* AfterCdata1 */;\n    };\n    Tokenizer.prototype.stateAfterCdata1 = function (c) {\n        if (c === \"]\")\n            this._state = 31 /* AfterCdata2 */;\n        else\n            this._state = 29 /* InCdata */;\n    };\n    Tokenizer.prototype.stateAfterCdata2 = function (c) {\n        if (c === \">\") {\n            // Remove 2 trailing chars\n            this.cbs.oncdata(this.buffer.substring(this.sectionStart, this._index - 2));\n            this._state = 1 /* Text */;\n            this.sectionStart = this._index + 1;\n        }\n        else if (c !== \"]\") {\n            this._state = 29 /* InCdata */;\n        }\n        // Else: stay in AFTER_CDATA_2 (`]]]>`)\n    };\n    Tokenizer.prototype.stateBeforeSpecialS = function (c) {\n        if (c === \"c\" || c === \"C\") {\n            this._state = 34 /* BeforeScript1 */;\n        }\n        else if (c === \"t\" || c === \"T\") {\n            this._state = 44 /* BeforeStyle1 */;\n        }\n        else {\n            this._state = 3 /* InTagName */;\n            this._index--; // Consume the token again\n        }\n    };\n    Tokenizer.prototype.stateBeforeSpecialSEnd = function (c) {\n        if (this.special === 2 /* Script */ && (c === \"c\" || c === \"C\")) {\n            this._state = 39 /* AfterScript1 */;\n        }\n        else if (this.special === 3 /* Style */ && (c === \"t\" || c === \"T\")) {\n            this._state = 48 /* AfterStyle1 */;\n        }\n        else\n            this._state = 1 /* Text */;\n    };\n    Tokenizer.prototype.stateBeforeSpecialLast = function (c, special) {\n        if (c === \"/\" || c === \">\" || whitespace(c)) {\n            this.special = special;\n        }\n        this._state = 3 /* InTagName */;\n        this._index--; // Consume the token again\n    };\n    Tokenizer.prototype.stateAfterSpecialLast = function (c, sectionStartOffset) {\n        if (c === \">\" || whitespace(c)) {\n            this.special = 1 /* None */;\n            this._state = 6 /* InClosingTagName */;\n            this.sectionStart = this._index - sectionStartOffset;\n            this._index--; // Reconsume the token\n        }\n        else\n            this._state = 1 /* Text */;\n    };\n    // For entities terminated with a semicolon\n    Tokenizer.prototype.parseFixedEntity = function (map) {\n        if (map === void 0) { map = this.xmlMode ? xml_json_1.default : entities_json_1.default; }\n        // Offset = 1\n        if (this.sectionStart + 1 < this._index) {\n            var entity = this.buffer.substring(this.sectionStart + 1, this._index);\n            if (Object.prototype.hasOwnProperty.call(map, entity)) {\n                this.emitPartial(map[entity]);\n                this.sectionStart = this._index + 1;\n            }\n        }\n    };\n    // Parses legacy entities (without trailing semicolon)\n    Tokenizer.prototype.parseLegacyEntity = function () {\n        var start = this.sectionStart + 1;\n        // The max length of legacy entities is 6\n        var limit = Math.min(this._index - start, 6);\n        while (limit >= 2) {\n            // The min length of legacy entities is 2\n            var entity = this.buffer.substr(start, limit);\n            if (Object.prototype.hasOwnProperty.call(legacy_json_1.default, entity)) {\n                this.emitPartial(legacy_json_1.default[entity]);\n                this.sectionStart += limit + 1;\n                return;\n            }\n            limit--;\n        }\n    };\n    Tokenizer.prototype.stateInNamedEntity = function (c) {\n        if (c === \";\") {\n            this.parseFixedEntity();\n            // Retry as legacy entity if entity wasn't parsed\n            if (this.baseState === 1 /* Text */ &&\n                this.sectionStart + 1 < this._index &&\n                !this.xmlMode) {\n                this.parseLegacyEntity();\n            }\n            this._state = this.baseState;\n        }\n        else if ((c < \"0\" || c > \"9\") && !isASCIIAlpha(c)) {\n            if (this.xmlMode || this.sectionStart + 1 === this._index) {\n                // Ignore\n            }\n            else if (this.baseState !== 1 /* Text */) {\n                if (c !== \"=\") {\n                    // Parse as legacy entity, without allowing additional characters.\n                    this.parseFixedEntity(legacy_json_1.default);\n                }\n            }\n            else {\n                this.parseLegacyEntity();\n            }\n            this._state = this.baseState;\n            this._index--;\n        }\n    };\n    Tokenizer.prototype.decodeNumericEntity = function (offset, base, strict) {\n        var sectionStart = this.sectionStart + offset;\n        if (sectionStart !== this._index) {\n            // Parse entity\n            var entity = this.buffer.substring(sectionStart, this._index);\n            var parsed = parseInt(entity, base);\n            this.emitPartial(decode_codepoint_1.default(parsed));\n            this.sectionStart = strict ? this._index + 1 : this._index;\n        }\n        this._state = this.baseState;\n    };\n    Tokenizer.prototype.stateInNumericEntity = function (c) {\n        if (c === \";\") {\n            this.decodeNumericEntity(2, 10, true);\n        }\n        else if (c < \"0\" || c > \"9\") {\n            if (!this.xmlMode) {\n                this.decodeNumericEntity(2, 10, false);\n            }\n            else {\n                this._state = this.baseState;\n            }\n            this._index--;\n        }\n    };\n    Tokenizer.prototype.stateInHexEntity = function (c) {\n        if (c === \";\") {\n            this.decodeNumericEntity(3, 16, true);\n        }\n        else if ((c < \"a\" || c > \"f\") &&\n            (c < \"A\" || c > \"F\") &&\n            (c < \"0\" || c > \"9\")) {\n            if (!this.xmlMode) {\n                this.decodeNumericEntity(3, 16, false);\n            }\n            else {\n                this._state = this.baseState;\n            }\n            this._index--;\n        }\n    };\n    Tokenizer.prototype.cleanup = function () {\n        if (this.sectionStart < 0) {\n            this.buffer = \"\";\n            this.bufferOffset += this._index;\n            this._index = 0;\n        }\n        else if (this.running) {\n            if (this._state === 1 /* Text */) {\n                if (this.sectionStart !== this._index) {\n                    this.cbs.ontext(this.buffer.substr(this.sectionStart));\n                }\n                this.buffer = \"\";\n                this.bufferOffset += this._index;\n                this._index = 0;\n            }\n            else if (this.sectionStart === this._index) {\n                // The section just started\n                this.buffer = \"\";\n                this.bufferOffset += this._index;\n                this._index = 0;\n            }\n            else {\n                // Remove everything unnecessary\n                this.buffer = this.buffer.substr(this.sectionStart);\n                this._index -= this.sectionStart;\n                this.bufferOffset += this.sectionStart;\n            }\n            this.sectionStart = 0;\n        }\n    };\n    /**\n     * Iterates through the buffer, calling the function corresponding to the current state.\n     *\n     * States that are more likely to be hit are higher up, as a performance improvement.\n     */\n    Tokenizer.prototype.parse = function () {\n        while (this._index < this.buffer.length && this.running) {\n            var c = this.buffer.charAt(this._index);\n            if (this._state === 1 /* Text */) {\n                this.stateText(c);\n            }\n            else if (this._state === 12 /* InAttributeValueDq */) {\n                this.stateInAttributeValueDoubleQuotes(c);\n            }\n            else if (this._state === 9 /* InAttributeName */) {\n                this.stateInAttributeName(c);\n            }\n            else if (this._state === 19 /* InComment */) {\n                this.stateInComment(c);\n            }\n            else if (this._state === 20 /* InSpecialComment */) {\n                this.stateInSpecialComment(c);\n            }\n            else if (this._state === 8 /* BeforeAttributeName */) {\n                this.stateBeforeAttributeName(c);\n            }\n            else if (this._state === 3 /* InTagName */) {\n                this.stateInTagName(c);\n            }\n            else if (this._state === 6 /* InClosingTagName */) {\n                this.stateInClosingTagName(c);\n            }\n            else if (this._state === 2 /* BeforeTagName */) {\n                this.stateBeforeTagName(c);\n            }\n            else if (this._state === 10 /* AfterAttributeName */) {\n                this.stateAfterAttributeName(c);\n            }\n            else if (this._state === 13 /* InAttributeValueSq */) {\n                this.stateInAttributeValueSingleQuotes(c);\n            }\n            else if (this._state === 11 /* BeforeAttributeValue */) {\n                this.stateBeforeAttributeValue(c);\n            }\n            else if (this._state === 5 /* BeforeClosingTagName */) {\n                this.stateBeforeClosingTagName(c);\n            }\n            else if (this._state === 7 /* AfterClosingTagName */) {\n                this.stateAfterClosingTagName(c);\n            }\n            else if (this._state === 32 /* BeforeSpecialS */) {\n                this.stateBeforeSpecialS(c);\n            }\n            else if (this._state === 21 /* AfterComment1 */) {\n                this.stateAfterComment1(c);\n            }\n            else if (this._state === 14 /* InAttributeValueNq */) {\n                this.stateInAttributeValueNoQuotes(c);\n            }\n            else if (this._state === 4 /* InSelfClosingTag */) {\n                this.stateInSelfClosingTag(c);\n            }\n            else if (this._state === 16 /* InDeclaration */) {\n                this.stateInDeclaration(c);\n            }\n            else if (this._state === 15 /* BeforeDeclaration */) {\n                this.stateBeforeDeclaration(c);\n            }\n            else if (this._state === 22 /* AfterComment2 */) {\n                this.stateAfterComment2(c);\n            }\n            else if (this._state === 18 /* BeforeComment */) {\n                this.stateBeforeComment(c);\n            }\n            else if (this._state === 33 /* BeforeSpecialSEnd */) {\n                this.stateBeforeSpecialSEnd(c);\n            }\n            else if (this._state === 53 /* BeforeSpecialTEnd */) {\n                stateAfterSpecialTEnd(this, c);\n            }\n            else if (this._state === 39 /* AfterScript1 */) {\n                stateAfterScript1(this, c);\n            }\n            else if (this._state === 40 /* AfterScript2 */) {\n                stateAfterScript2(this, c);\n            }\n            else if (this._state === 41 /* AfterScript3 */) {\n                stateAfterScript3(this, c);\n            }\n            else if (this._state === 34 /* BeforeScript1 */) {\n                stateBeforeScript1(this, c);\n            }\n            else if (this._state === 35 /* BeforeScript2 */) {\n                stateBeforeScript2(this, c);\n            }\n            else if (this._state === 36 /* BeforeScript3 */) {\n                stateBeforeScript3(this, c);\n            }\n            else if (this._state === 37 /* BeforeScript4 */) {\n                stateBeforeScript4(this, c);\n            }\n            else if (this._state === 38 /* BeforeScript5 */) {\n                this.stateBeforeSpecialLast(c, 2 /* Script */);\n            }\n            else if (this._state === 42 /* AfterScript4 */) {\n                stateAfterScript4(this, c);\n            }\n            else if (this._state === 43 /* AfterScript5 */) {\n                this.stateAfterSpecialLast(c, 6);\n            }\n            else if (this._state === 44 /* BeforeStyle1 */) {\n                stateBeforeStyle1(this, c);\n            }\n            else if (this._state === 29 /* InCdata */) {\n                this.stateInCdata(c);\n            }\n            else if (this._state === 45 /* BeforeStyle2 */) {\n                stateBeforeStyle2(this, c);\n            }\n            else if (this._state === 46 /* BeforeStyle3 */) {\n                stateBeforeStyle3(this, c);\n            }\n            else if (this._state === 47 /* BeforeStyle4 */) {\n                this.stateBeforeSpecialLast(c, 3 /* Style */);\n            }\n            else if (this._state === 48 /* AfterStyle1 */) {\n                stateAfterStyle1(this, c);\n            }\n            else if (this._state === 49 /* AfterStyle2 */) {\n                stateAfterStyle2(this, c);\n            }\n            else if (this._state === 50 /* AfterStyle3 */) {\n                stateAfterStyle3(this, c);\n            }\n            else if (this._state === 51 /* AfterStyle4 */) {\n                this.stateAfterSpecialLast(c, 5);\n            }\n            else if (this._state === 52 /* BeforeSpecialT */) {\n                stateBeforeSpecialT(this, c);\n            }\n            else if (this._state === 54 /* BeforeTitle1 */) {\n                stateBeforeTitle1(this, c);\n            }\n            else if (this._state === 55 /* BeforeTitle2 */) {\n                stateBeforeTitle2(this, c);\n            }\n            else if (this._state === 56 /* BeforeTitle3 */) {\n                stateBeforeTitle3(this, c);\n            }\n            else if (this._state === 57 /* BeforeTitle4 */) {\n                this.stateBeforeSpecialLast(c, 4 /* Title */);\n            }\n            else if (this._state === 58 /* AfterTitle1 */) {\n                stateAfterTitle1(this, c);\n            }\n            else if (this._state === 59 /* AfterTitle2 */) {\n                stateAfterTitle2(this, c);\n            }\n            else if (this._state === 60 /* AfterTitle3 */) {\n                stateAfterTitle3(this, c);\n            }\n            else if (this._state === 61 /* AfterTitle4 */) {\n                this.stateAfterSpecialLast(c, 5);\n            }\n            else if (this._state === 17 /* InProcessingInstruction */) {\n                this.stateInProcessingInstruction(c);\n            }\n            else if (this._state === 64 /* InNamedEntity */) {\n                this.stateInNamedEntity(c);\n            }\n            else if (this._state === 23 /* BeforeCdata1 */) {\n                stateBeforeCdata1(this, c);\n            }\n            else if (this._state === 62 /* BeforeEntity */) {\n                stateBeforeEntity(this, c);\n            }\n            else if (this._state === 24 /* BeforeCdata2 */) {\n                stateBeforeCdata2(this, c);\n            }\n            else if (this._state === 25 /* BeforeCdata3 */) {\n                stateBeforeCdata3(this, c);\n            }\n            else if (this._state === 30 /* AfterCdata1 */) {\n                this.stateAfterCdata1(c);\n            }\n            else if (this._state === 31 /* AfterCdata2 */) {\n                this.stateAfterCdata2(c);\n            }\n            else if (this._state === 26 /* BeforeCdata4 */) {\n                stateBeforeCdata4(this, c);\n            }\n            else if (this._state === 27 /* BeforeCdata5 */) {\n                stateBeforeCdata5(this, c);\n            }\n            else if (this._state === 28 /* BeforeCdata6 */) {\n                this.stateBeforeCdata6(c);\n            }\n            else if (this._state === 66 /* InHexEntity */) {\n                this.stateInHexEntity(c);\n            }\n            else if (this._state === 65 /* InNumericEntity */) {\n                this.stateInNumericEntity(c);\n                // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n            }\n            else if (this._state === 63 /* BeforeNumericEntity */) {\n                stateBeforeNumericEntity(this, c);\n            }\n            else {\n                this.cbs.onerror(Error(\"unknown _state\"), this._state);\n            }\n            this._index++;\n        }\n        this.cleanup();\n    };\n    Tokenizer.prototype.finish = function () {\n        // If there is remaining data, emit it in a reasonable way\n        if (this.sectionStart < this._index) {\n            this.handleTrailingData();\n        }\n        this.cbs.onend();\n    };\n    Tokenizer.prototype.handleTrailingData = function () {\n        var data = this.buffer.substr(this.sectionStart);\n        if (this._state === 29 /* InCdata */ ||\n            this._state === 30 /* AfterCdata1 */ ||\n            this._state === 31 /* AfterCdata2 */) {\n            this.cbs.oncdata(data);\n        }\n        else if (this._state === 19 /* InComment */ ||\n            this._state === 21 /* AfterComment1 */ ||\n            this._state === 22 /* AfterComment2 */) {\n            this.cbs.oncomment(data);\n        }\n        else if (this._state === 64 /* InNamedEntity */ && !this.xmlMode) {\n            this.parseLegacyEntity();\n            if (this.sectionStart < this._index) {\n                this._state = this.baseState;\n                this.handleTrailingData();\n            }\n        }\n        else if (this._state === 65 /* InNumericEntity */ && !this.xmlMode) {\n            this.decodeNumericEntity(2, 10, false);\n            if (this.sectionStart < this._index) {\n                this._state = this.baseState;\n                this.handleTrailingData();\n            }\n        }\n        else if (this._state === 66 /* InHexEntity */ && !this.xmlMode) {\n            this.decodeNumericEntity(3, 16, false);\n            if (this.sectionStart < this._index) {\n                this._state = this.baseState;\n                this.handleTrailingData();\n            }\n        }\n        else if (this._state !== 3 /* InTagName */ &&\n            this._state !== 8 /* BeforeAttributeName */ &&\n            this._state !== 11 /* BeforeAttributeValue */ &&\n            this._state !== 10 /* AfterAttributeName */ &&\n            this._state !== 9 /* InAttributeName */ &&\n            this._state !== 13 /* InAttributeValueSq */ &&\n            this._state !== 12 /* InAttributeValueDq */ &&\n            this._state !== 14 /* InAttributeValueNq */ &&\n            this._state !== 6 /* InClosingTagName */) {\n            this.cbs.ontext(data);\n        }\n        /*\n         * Else, ignore remaining data\n         * TODO add a way to remove current tag\n         */\n    };\n    Tokenizer.prototype.getSection = function () {\n        return this.buffer.substring(this.sectionStart, this._index);\n    };\n    Tokenizer.prototype.emitToken = function (name) {\n        this.cbs[name](this.getSection());\n        this.sectionStart = -1;\n    };\n    Tokenizer.prototype.emitPartial = function (value) {\n        if (this.baseState !== 1 /* Text */) {\n            this.cbs.onattribdata(value); // TODO implement the new event\n        }\n        else {\n            this.cbs.ontext(value);\n        }\n    };\n    return Tokenizer;\n}());\nexports.default = Tokenizer;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}